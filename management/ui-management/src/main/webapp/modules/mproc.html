
<h3 style="margin: 0px;">
	<i class="icon-link"></i> Message Processing Rules
</h3>
<hr style="margin: 10 0px;" />
<span style="float: right;">
	<button id="refresh" style="float: right; margin-right: 20px; margin-left: 20px; height: 30px;" class="btn btn-medium btn-success" data-toggle="tooltip" data-placement="left" title="Refresh MProc Rules List" onclick="updateMProc();">
		<i class="icon-refresh"></i>
	</button>
</span>
<span id="esmes-table-wrapper">
	<table id="no-esmes-table" class="table" style="display: none;">
		<tr>
			<td>
				<div class="alert alert-info fade in">
					<strong>No message processing rule defined yet!</strong> 
				</div>
			</td>
		</tr>
	</table>

	<table id="esmes-table" class="table table-hover">
		<thead>
			<tr>
				<th style="width: 30px;">&nbsp;</th>
				<th>Id</th>
				<th>Rule Class Name</th>
				<th>Trigger point</th>
				<th>Rule Parameters</th>
				<th style="text-align: center; width: 150px;">Actions</th>
			</tr>
		</thead>
		<tbody>
		</tbody>
	</table>
	<p>
		<a href="#entities-modal" role="button" class="btn btn-info btn-small" data-toggle="modal" ><i class="icon-link"></i> Create Default Message Processing Rule</a> &nbsp;&nbsp;
		<a href="#entities-modal-custom" role="button" class="btn btn-info btn-small" data-toggle="modal" ><i class="icon-link"></i> Create Custom Message Processing Rule</a>
	</p>	
</span>

<div id="entities-modal-custom" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		<h3>Create Custom Message Processing Rule</h3>
	</div>
	
	<div id="entities-modal-body-custom" class="modal-body">
		<div class="alert alert-error" id="login-settings-error-custom" style="display:none;">
		  <button type="button" class="close">&times;</button>
		  Some Fields are not correctly filled out, please double check the settings below !
		</div>
		<p>
			<span>
				<div id="div-id-custom" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="A unique id for this message processing rule. Rules are sorted in ascending order based on this id. All the matching rules are applied">
						<span class="add-on">Id</span>
						<input id="id-custom" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Id" />
					</span>				
				</div>
				
				<div id="div-classname-custom" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="the name of class of mproc rules implementation. For the default implementation class name is mproc.">
						<span class="add-on">Class Name</span>
						<input id="classname-custom" type="text" class="input-mini" style="width: 220px; margin-right: 12px; text-align: center;" placeholder="Class Name" />
					</span>				
				</div>
				
				<div id="div-parameters-custom" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="the parameters that should be set for this mproc">
						<span class="add-on">Parameters</span>
						<input id="parameters-custom" type="text" class="input-mini" style="width: 420px; margin-right: 12px; text-align: center;" placeholder="parameters" />
					</span>				
				</div>								
				
				<button id="add-entity-button-custom" class="btn btn btn-primary" onclick="createMProcCustom()">Create</button>
			</span>
		</p>
		<p>&nbsp;</p>
		<div class="accordion" id="entities-accordion-custom">
		</div>
	</div>
	<div class="modal-footer">
		<a href="#" onclick="$('#entities-modal-custom').modal('hide'); return false;" class="btn">Close</a>
	</div>
</div>

<div id="entities-modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		<h3>Create Message Processing Rule</h3>
	</div>
	<div id="entities-modal-body" class="modal-body">
		<div class="alert alert-error" id="login-settings-error" style="display:none;">
		  <button type="button" class="close">&times;</button>
		  Some Fields are not correctly filled out, please double check the settings below !
		</div>
		<p>
			<span>
				<div id="div-id" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="A unique id for this message processing rule. Rules are sorted in ascending order based on this id. All the matching rules are applied">
						<span class="add-on">Id</span>
						<input id="id" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Id" />
					</span>				
				</div>

				<div id="div-xxx" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom">
						<span class="add-on">--- Conditions ---</span>
					</span>				
				</div>									
				
				<div id="div-networkidmask" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if target SMS is current networkid with this rule's networkidmask. Set value to -1 as wild card to match all the network id's. Default value is -1">
						<span class="add-on">Network Id Mask</span>
						<input id="networkidmask" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Destination digits mask" />
					</span>				
				</div>	

				<div id="div-originnetworkidmask" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if SMS origination networkid match\'s with this rule\'s receiptnetworkidmask. Set value to -1 as wild card to match all the network id\'s. Default value is -1.">
						<span class="add-on">Originating Network Id Mask</span>
						<input id="originnetworkidmask" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Originating Network Id Mask" />
					</span>				
				</div>	

				<div id="div-receiptnetworkidmask" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only Rule will be applied only if\na) a message is a delivery receipt,\nb) the delivery receipt is recognized by SMSC GW\nc) an original message for the delivery receipt is found\nd) networkId of the original message == receiptnetworkidmask.\nSet value to -1 as wild card to match all the network id\'s. Default value is -1.">
						<span class="add-on">Receipt Network Id Mask</span>
						<input id="receiptnetworkidmask" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Receipt Network Id Mask" />
					</span>				
				</div>	

				
				<div id="div-desttonmask" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if destination type of number (TON) of target SMS match's with this rule's desttonmask. Set value to -1 as wild card to match all the TON. Valid values of TON are &#13; 0 : Unknown &#13; 1 : International &#13; 2 : National &#13; 3 : Network Specific &#13; 4 : Subscriber &#13; 5 : Alphanumeric &#13; 6 : Abbreviated &#13; 7 : Reserved &#13; Default value is -1">
						<span class="add-on">Destination Type of Number (TON)</span>
						<select id="desttonmask" >
							<option value="-1">-1: Null</option>
							<option value="0">0 : Unknown</option>
							<option value="1">1 : International</option>
							<option value="2">2 : National</option>
							<option value="3">3 : Network Specific</option>
							<option value="4">4 : Subscriber Number</option>
							<option value="5">5 : Alphanumeric</option>
							<option value="6">6 : Abbreviated</option>
							<option value="7">7 : Reserved</option>
						</select>
					</span>	
				</div>
								
				<div id="div-destnpimask" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if destination number plan indicator (NPI) of target SMS match's with this rule's destnpimask. Set value to -1 as wild card to match all the NPI. Valid values of TON are &#13; 0  : Unknown &#13; 1  : ISDN (E163/E164) &#13; 3  : Data (X.121) &#13; 4  : Telex (F.69) &#13; 6  : Land Mobile (E.212) &#13; 8  : National &#13; 9  : Private &#13; 10 : ERMES &#13; 14 : Internet &#13; 18 : WAP Client Id &#13; Default value is -1 ">
						<span class="add-on">Destination Number Plan Indicator (NPI)</span>
						<select id="destnpimask" >
							<option value="-1">-1 : Null</option>
							<option value="0">0 : Unknown</option>
							<option value="1">1 : ISDN (E163/E164)</option>
							<option value="3">3 : Data (X.121)</option>
							<option value="4">4 : Telex (F.69)</option>
							<option value="6">6 : Land Mobile (E.212)</option>
							<option value="8">8: National</option>
							<option value="9">9 : Private</option>
							<option value="10">10 : ERMES</option>
							<option value="14">14 : Internet (IP)</option>
							<option value="18">18 : WAP Client Id</option>
						</select>
					</span>	
				</div>
				
				<div id="div-destdigmask" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if destination number of target SMS match's with this rule's destdigmask. destdigmask is java regular expression. Set value to -1 or leave blank as wild card to match all the digits of target SMS destination. Default value is -1">
						<span class="add-on">Destination Digit Mask</span>
						<input id="destdigmask" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Destination digits mask" />
					</span>				
				</div>

				<div id="div-sourcetonmask" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if source type of number (TON) of target SMS match's with this rule's sourcetonmask. Set value to -1 as wild card to match all the TON. Valid values of TON are &#13; 0 : Unknown &#13; 1 : International &#13; 2 : National &#13; 3 : Network Specific &#13; 4 : Subscriber &#13; 5 : Alphanumeric &#13; 6 : Abbreviated &#13; 7 : Reserved &#13; Default value is -1">
						<span class="add-on">Source Type of Number (TON)</span>
						<select id="sourcetonmask" >
							<option value="-1">-1: Null</option>
							<option value="0">0 : Unknown</option>
							<option value="1">1 : International</option>
							<option value="2">2 : National</option>
							<option value="3">3 : Network Specific</option>
							<option value="4">4 : Subscriber Number</option>
							<option value="5">5 : Alphanumeric</option>
							<option value="6">6 : Abbreviated</option>
							<option value="7">7 : Reserved</option>
						</select>
					</span>	
				</div>
								
				<div id="div-sourcenpimask" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if source number plan indicator (NPI) of target SMS match's with this rule's sourcenpimask. Set value to -1 as wild card to match all the NPI. Valid values of TON are &#13; 0  : Unknown &#13; 1  : ISDN (E163/E164) &#13; 3  : Data (X.121) &#13; 4  : Telex (F.69) &#13; 6  : Land Mobile (E.212) &#13; 8  : National &#13; 9  : Private &#13; 10 : ERMES &#13; 14 : Internet &#13; 18 : WAP Client Id &#13; Default value is -1 ">
						<span class="add-on">Source Number Plan Indicator (NPI)</span>
						<select id="sourcenpimask" >
							<option value="-1">-1 : Null</option>
							<option value="0">0 : Unknown</option>
							<option value="1">1 : ISDN (E163/E164)</option>
							<option value="3">3 : Data (X.121)</option>
							<option value="4">4 : Telex (F.69)</option>
							<option value="6">6 : Land Mobile (E.212)</option>
							<option value="8">8: National</option>
							<option value="9">9 : Private</option>
							<option value="10">10 : ERMES</option>
							<option value="14">14 : Internet (IP)</option>
							<option value="18">18 : WAP Client Id</option>
						</select>
					</span>	
				</div>
				
				<div id="div-sourcedigmask" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if source number of target SMS match's with this rule's sourcedigmask. sourcedigmask is java regular expression. Set value to -1 or leave blank as wild card to match all the digits of target SMS source. Default value is -1">
						<span class="add-on">Source Digit Mask</span>
						<input id="sourcedigmask" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Source digits mask" />
					</span>				
				</div>	

				<div id="div-imsidigitsmask" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if IMSI digits after a successfull SRI request match's with this rule's imsidigitsmask. imsidigitsmask is java regular expression. This condition never fits if a message is not delivering to SS7 or IMSI is not obtained. Set value to null or -1 as wild card to match all the digits of IMSI. Default value is -1.">
						<span class="add-on">IMSI Digits Mask</span>
						<input id="imsidigitsmask" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="IMSI Digits Mask" />
					</span>				
				</div>	
				
				<div id="div-nnndigitsmask" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if NetworkNodeNumber digits (VLR address where subscriber is) after a successfull SRI request match's with this rule's nnndigitsmask. nnndigitsmask is java regular expression. This condition never fits if a message is not delivering to SS7 or NetworkNodeNumber is not obtained. Set value to null or -1 as wild card to match all the digits of NetworkNodeNumber. Default value is -1.">
						<span class="add-on">NetworkNodeNumber (VLR) Digits Mask</span>
						<input id="nnndigitsmask" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="NetworkNodeNumber (VLR) Digits Mask" />
					</span>				
				</div>	
				
				<div id="div-originatingmask" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if target SMS is originated from channel as specified by originatingmask. Select All as wild card to match all the origination type. Valid values are &#13; SMPP &#13; SS7_MO &#13; SS7_HR &#13; SIP &#13; HTTP &#13; Default value is All (null)">
						<span class="add-on">Originating Channel</span>
						<select id="originatingmask" >
							<option value="All">All</option>
							<option value="SS7_MO">SS7 Mobile Originated</option>
							<option value="SS7_HR">SS7 Home Routing</option>
							<option value="SMPP">SMPP</option>
							<option value="SIP">SIP</option>
							<option value="HTTP">HTTP</option>
						</select>
					</span>	
				</div>	
				
				<div id="div-origesmenamemask" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if target SMS is originated from SMPP channel (ESME) and who's name match's with originating ESME name mask (Java Regular Expression). Set -1 as wild card to match all the ESME.">
						<span class="add-on">Originating ESME Name Mask</span>
						<input id="origesmenamemask" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Originating ESME name mask" />
					</span>				
				</div>
				
				<div id="div-originatorsccpaddressmask" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if SCCP CallingPartyAddress digits match's with this rule's originatorsccpaddressmask. originatorsccpaddressmask is java regular expression. Set value to null or -1 as wild card to match all the digits of CallingPartyAddress digits. Default value is -1">
						<span class="add-on">Originating (CallingPartyAddress) SCCP Digit Mask</span>
						<input id="originatorsccpaddressmask" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Originating (CallingPartyAddress) SCCP digit mask" />
					</span>				
				</div>									
				
				<div id="div-processingtype" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if a Delivery step match's with this rule's processingtype. Value -1 will match all steps. Default value is -1. Possible values are:&#13;SMPP - delivery via SMPP channel&#13;SS7_SRI - sending of SRI request to HLR&#13;SS7_MT - MT delivery to SS7 network&#13;SIP - delivery via SIP channel">
						<span class="add-on">Delivery step</span>
						<select id="processingtype" >
							<option value="All">All</option>
							<option value="SS7_SRI">Delivering via SS7 - SRI Request</option>
							<option value="SS7_MT">Delivering via SS7 - MT operation</option>
							<option value="SMPP">Delivering via SMPP</option>
							<option value="SIP">Delivering via SIP</option>
						</select>
					</span>	
				</div>	
				
				<div id="div-errorcode" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if an internal SMSC GW's delivery error code value match's with this rule's errorcode. Value 0 means a successful delivery, non 0 value means some delivery error. You can specify several values via comma (example: &#34;6,7,8&#34;). Value -1 will match any error code. Default value is -1.">
						<span class="add-on">Delivery error code value</span>
						<input id="errorcode" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Delivery error code value" />
					</span>				
				</div>

				<div id="div-tlvtype" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Rule will be applied only if message contains an optional parameter with tag equalling &lt;tag key&gt; and has a tag value with a type which equals the &lt;value type&gt; and a value which equals the value set here. Value -1 will match any optional parameter. Possible values for &lt;value type&gt; are &#13; string &#13; int &#13; byte &#13;Default value for &lt;tag key&gt; is -1. Default value for &lt;value type&gt; is string. Default value for &lt;tag value&gt; is -1.">
						<span class="add-on">Tlv To Match</span>
						<input id="tlvkey" type="text" class="input-mini" style="width: 80px; text-align: center;" placeholder="Tlv key" />
						<select id="tlvtype" style="width: 80px;">
							<option value="string">String</option>
							<option value="int">Integer</option>
							<option value="byte">Byte</option>
						</select>
						<input id="tlvvalue" type="text" class="input-mini" style="width: 80px; margin-right: 12px; text-align: center;" placeholder="Tlv value" />
					</span>
				</div>
				
				<div id="div-percent" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Defines probability with which mproc rule will be applied to a message. Default value -1 means that mproc rule will be applied to 100% of messages.">
						<span class="add-on">Percent</span>
						<input id="percent" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Percent value" />
					</span>				
				</div>


				<div id="div-xxx" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom">
						<span class="add-on">--- Actions ---</span>
					</span>				
				</div>									
				
				<div id="div-newnetworkid" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule match's, the target SMS's network id will be change to one set here. This will allow to received SMS from different network and terminate on different network. Set this to -1 to keep original network id. Default value is -1.">
						<span class="add-on">New Network Id</span>
						<input id="newnetworkid" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Destination digits mask" />
					</span>				
				</div>	
				
				<div id="div-newdestton" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule match's, the target SMS's destination type of number(TON) will be changed to one set here. Set this to -1 to keep original TON. Default value is -1.">
						<span class="add-on">New Type Of Number (TON)</span>
						<select id="newdestton" >
							<option value="-1">-1 : null</option>
							<option value="0">0 : Unknown</option>
							<option value="1">1 : International</option>
							<option value="2">2 : National</option>
							<option value="3">3 : Network Specific</option>
							<option value="4">4 : Subscriber Number</option>
							<option value="5">5 : Alphanumeric</option>
							<option value="6">6 : Abbreviated</option>
							<option value="7">7 : Reserved</option>
						</select>
					</span>	
				</div>
								
				<div id="div-newdestnpi" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule match's, the target SMS's destination number plan indicator (NPI) will be changed to one set here. Set this to -1 to keep original NPI. Default value is -1.">
						<span class="add-on">New Number Plan Indicator (NPI)</span>
						<select id="newdestnpi" >
							<option value="-1">-1 : null</option>
							<option value="0">0 : Unknown</option>
							<option value="1">1 : ISDN (E163/E164)</option>
							<option value="3">3 : Data (X.121)</option>
							<option value="4">4 : Telex (F.69)</option>
							<option value="6">6 : Land Mobile (E.212)</option>
							<option value="8">8 : National</option>
							<option value="9">9 : Private</option>
							<option value="10">10 : ERMES</option>
							<option value="14">14 : Internet (IP)</option>
							<option value="18">18 : WAP Client Id</option>
						</select>
					</span>	
				</div>	

				<div id="div-adddestdigprefix" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule match's, the target SMS's destination number will be prefixed with adddestdigprefix set here. Set this to -1 or leave leave empty to keep original destination number. Default value is -1.">
						<span class="add-on">Destination address prefix</span>
						<input id="adddestdigprefix" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Destination digits mask" />
					</span>
				</div>																		

				<div id="div-addsourcedigprefix" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule match's, the target SMS's source number will be prefixed with addsourcedigprefix set here. Set this to -1 or leave leave empty to keep original source number. Default value is -1.">
						<span class="add-on">Source address prefix</span>
						<input id="addsourcedigprefix" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Source digits mask" />
					</span>
				</div>																		

				<div id="div-newsourceton" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule match's, the target SMS's source address type of number(TON) will be changed to one set here. Set this to -1 to keep original TON. Default value is -1.">
						<span class="add-on">New Type Of Number (TON)</span>
						<select id="newsourceton" >
							<option value="-1">-1 : null</option>
							<option value="0">0 : Unknown</option>
							<option value="1">1 : International</option>
							<option value="2">2 : National</option>
							<option value="3">3 : Network Specific</option>
							<option value="4">4 : Subscriber Number</option>
							<option value="5">5 : Alphanumeric</option>
							<option value="6">6 : Abbreviated</option>
							<option value="7">7 : Reserved</option>
						</select>
					</span>	
				</div>
								
				<div id="div-newsourcenpi" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule match's, the target SMS's source address number plan indicator (NPI) will be changed to one set here. Set this to -1 to keep original NPI. Default value is -1.">
						<span class="add-on">New Number Plan Indicator (NPI)</span>
						<select id="newsourcenpi" >
							<option value="-1">-1 : null</option>
							<option value="0">0 : Unknown</option>
							<option value="1">1 : ISDN (E163/E164)</option>
							<option value="3">3 : Data (X.121)</option>
							<option value="4">4 : Telex (F.69)</option>
							<option value="6">6 : Land Mobile (E.212)</option>
							<option value="8">8 : National</option>
							<option value="9">9 : Private</option>
							<option value="10">10 : ERMES</option>
							<option value="14">14 : Internet (IP)</option>
							<option value="18">18 : WAP Client Id</option>
						</select>
					</span>	
				</div>	
				
				<div id="div-newsourceaddr" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule match's, the target SMS's source address number will be changed to one set here. Set this to -1 or leave empty to keep original source address number. Dfault value is -1.">
						<span class="add-on">New Source Address</span>
						<input id="newsourceaddr" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="New Source Address digits" />
					</span>				
				</div>
				
				<div id="div-mtlocalsccp]gt" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule matches, the target SMS's destination global title (GT) will be changed to one set with this command. Set this to -1 to keep original GT. Default value is -1.">
						<span class="add-on">New GT for local SCCP address of MT  message</span>
						<input id="mtlocalsccpgt" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Global Title for MT message" />
					</span>				
				</div>
				
				<div id="div-mtremotesccptt" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule matches, the target SMS's destination translation type (TT) will be changed to one set with this command. Set this to -1 to keep original TT. Default value is -1.">
						<span class="add-on">New TT for remote SCCP address of MT message</span>
						<input id="mtremotesccptt" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Translation Type for MT message" />
					</span>				
				</div>
				
				<div id="div-makecopy" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule match's, and makecopy is set to true, a new copy of SMS is created. If new SMS is created all above parameters like networkidmask, newnetworkid, newdestton, newdestnpi, adddestdigprefix, newsourceton, newsourcenpi, newsourceaddr will be applied to new SMS">
						<span class="add-on">Make Copy</span>
						<select id="makecopy" >
							<option value="false">False</option>
							<option value="true">True</option>
						</select>
					</span>	
				</div>	

				<div id="div-hrbypass" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule match's inside Home Routing procedure after SMSC GW receives a response from a local HLR then SMSC GW will bypass HR procedure by sending back to an original SMSC GW origin original IMSI and NNN. ">
						<span class="add-on">ByPass HR procedure after SRI to a local HLR</span>
						<select id="hrbypass" >
							<option value="false">False</option>
							<option value="true">True</option>
						</select>
					</span>	
				</div>
							
				<div id="div-dropaftersri" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule match's and if a MAP SRI success response is received, message will be dropped without delivery attempt. A delivery response in this case will contain extra fields (IMSI and NetworkNodeNumber values). This action is applied only for SMS that are attempted to be delivered to SS7 network. ">
						<span class="add-on">Drop After MAP SRI Request</span>
						<select id="dropaftersri" >
							<option value="false">False</option>
							<option value="true">True</option>
						</select>
					</span>	
				</div>

				
				<div id="div-newnetworkidaftersri" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule match's and if a MAP SRI success response is received, message will be rerouted for delivery to another networkId. This action is applied only for SMS that are attempted to be delivered to SS7 network.">
						<span class="add-on">Reroute after MAP SRI Request</span>
						<input id="newnetworkidaftersri" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Reroute after MAP SRI Request" />
					</span>				
				</div>	
				
				<div id="div-newnetworkidafterpermfail" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule match's and if a message delivery has failed permanently, message will be rerouted for delivery to another networkId.">
						<span class="add-on">Reroute after permanent failure</span>
						<input id="newnetworkidafterpermfail" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Reroute after permanent failure" />
					</span>				
				</div>	
							
				<div id="div-dropaftertempfail" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule match's and if a message delivery has failed temporary, message will be dropped without any new delivery attempts.">
						<span class="add-on">Drop after temporary failure</span>
						<select id="dropaftertempfail" >
							<option value="false">False</option>
							<option value="true">True</option>
						</select>
					</span>	
				</div>
				
				<div id="div-newnetworkidaftertempfail" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule match's and if a message delivery has failed temporary, message will be rerouted for delivery to another networkId.">
						<span class="add-on">Reroute after temporary failure</span>
						<input id="newnetworkidaftertempfail" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Reroute after temporary failure" />
					</span>				
				</div>	
				
				<div id="div-droponarrival" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="This action is performed at the step when message has arrived to the server. Message will be dropped without delivery attempt and success response will be returned to a sender.">
						<span class="add-on">Drop upon arrival to the server</span>
						<select id="droponarrival" >
							<option value="false">False</option>
							<option value="true">True</option>
						</select>
					</span>	
				</div>
				
				<div id="div-rejectonarrival" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="This action is performed at the step when message has arrived to the server. If value is NONE, no action will be performed. Otherwise message will be rejected without delivery attempt and reject response will be returned to a sender.">
						<span class="add-on">Reject upon arrival to the server</span>
						<select id="rejectonarrival" >
							<option value="NONE">NONE</option>
							<option value="DEFAULT">DEFAULT</option>
							<option value="UNEXPECTED_DATA_VALUE">UNEXPECTED_DATA_VALUE</option>
							<option value="SYSTEM_FAILURE">SYSTEM_FAILURE</option>
							<option value="THROTTLING">THROTTLING</option>
							<option value="FACILITY_NOT_SUPPORTED">FACILITY_NOT_SUPPORTED</option>
						</select>
					</span>	
				</div>	

				<div id="div-remove_tlv" class="control-group">
					<span class="input-prepend" data-toggle="tooltip" data-placement="bottom" title="Once rule matches, the target SMS's optional parameter which matches the one set here will be removed. Set this to -1 to not remove any optional parameter. Default value is -1.">
						<span class="add-on">Remove Tlv</span>
						<input id="remove_tlv" type="text" class="input-mini" style="width: 120px; margin-right: 12px; text-align: center;" placeholder="Remove tlv" />
					</span>
				</div>

				<button id="add-entity-button" class="btn btn btn-primary" onclick="createMProc()">Create</button>
			</span>
		</p>
		<p>&nbsp;</p>
		<div class="accordion" id="entities-accordion">
		</div>
	</div>
	<div class="modal-footer">
		<a href="#" onclick="$('#entities-modal').modal('hide'); return false;" class="btn">Close</a>
	</div>
</div>

<script type="text/javascript">

	function processRuleParameters(ruleparameters, parameter){
		ruleparameters = ruleparameters.toLowerCase();
		parameter = parameter.toLowerCase();
		var index = ruleparameters.indexOf(parameter);
		if(index == -1){
			return "-1";
		}

		if(index!=0 && ruleparameters[index-1]!=" ") {
			var index = ruleparameters.indexOf(parameter, index+1);
			if(index == -1){
				return "-1";
			}
		}
		var result = null;
		if(parameter === "tlv") {
			var tlvtype = "string";
			var tlvkey = -1;
			var tlvvalue = -1;
			//parse type
			var typeStartIndex = index + 3;//"tlv"
			var typeEndIndex = ruleparameters.indexOf("_", typeStartIndex);
			if(typeEndIndex !=-1){
				tlvtype = ruleparameters.substring(typeStartIndex,typeEndIndex);

				//parse key
				var keyStartIndex = typeEndIndex + 1;
				var keyEndIndex = ruleparameters.indexOf("=", keyStartIndex);
				//if(keyEndIndex != -1){
				tlvkey = ruleparameters.substring(keyStartIndex,keyEndIndex);
				//}
				//parse value
				var valueStartIndex = keyEndIndex + 1;
				var valueEndIndex = ruleparameters.indexOf(",", valueStartIndex);
				tlvvalue = ruleparameters.substring(valueStartIndex,valueEndIndex);
			}
			result = [tlvkey, tlvtype, tlvvalue];
		} else {
			var valueStartIndex = ruleparameters.indexOf("=", index);
			valueStartIndex = valueStartIndex+1;

			var valueEndIndex = ruleparameters.indexOf(",", index);
			if(valueEndIndex != -1){
				return (ruleparameters.substring(valueStartIndex,valueEndIndex));
			}
			result = (ruleparameters.substring(valueStartIndex));
		}
		return result;
	}

	function convertTon(ton){
		switch(ton){
		case -1:
			return "null";
		case 0:
			return "Unknown";
		case 1:
			return "International";
		case 2:
			return "National";
		case 3:
			return "Network Specific";
		case 4:
			return "Subscriber Number";
		case 5:
			return "Alphanumeric";
		case 6:
			return "Abbreviated";
		case 7:
			return "Reserved";
		default:
			return "NA";
		}
	}
	
	function convertNpi(npi){
		switch(npi){
		case -1:
			return "null";
		case 0:
			return "Unknown";
		case 1:
			return "ISDN (E163/E164)";
		case 3:
			return "Data (X.121)";
		case 4:
			return "Telex (F.69)";
		case 6:
			return "Land Mobile (E.212)";
		case 8:
			return "National";
		case 9:
			return "Private";
		case 10:
			return "ERMES";
		case 14:
			return "Internet (IP)";
		case 18:
			return "WAP Client Id";
		default:
			return "NA";
		}
	}	
	
	
	
	function updateMProc() {
		mbeanSearch="org.mobicents.smsc:layer=MProcManagement,name=*";
		var mbeanVar;
		$.ajax({
			dataType: "json",
			url: window.jolokiaProtocol + "//" + window.jolokiaAddress + ":" + window.jolokiaPort + "/jolokia/search/" + mbeanSearch
		})
		.done(function(html) {
			if (html.error) {
				logToConsole("ERROR", html.error);
			}
			else {		
				
				$('.service-row').remove();

				jQuery.each(html.value, function() {
					mbeanVar = this;
					
					
					jolokia.request(
							[
								{ type: "read", mbean: mbeanVar },
							],
							{ success: [
								function(response) {
									
									var mProcRules = response.value.MProcRules;
									var noOfMProcRules = 0;
									jQuery.each(mProcRules, function(index, value) {
										
										noOfMProcRules = noOfMProcRules + 1;
									
										var id = value.id;
										var ruleclassname = value.ruleClassName;
										var forpostarrivalstate = value.forPostArrivalState;

										var forposthrsristate = value.forPostHrSriState;
										var forpostpredeliverystate = value.forPostPreDeliveryState;

										var forpostimsirequeststate = value.forPostImsiRequestState;
										var forpostdeliverystate = value.forPostDeliveryState;
										var forpostdeliverytempfailurestate = value.forPostDeliveryTempFailureState;
										var ruleparameters = value.ruleParameters;

										var fortrigger = "" + (forpostarrivalstate==true ? "Arriv " : "") + (forposthrsristate==true ? "HrSri " : "") + (forpostpredeliverystate==true ? "PreDlv " : "") +
										                 (forpostimsirequeststate==true ? "ImsiReq " : "") + (forpostdeliverystate==true ? "DvldFail " : "") + (forpostdeliverytempfailurestate==true ? "TempFail " : "");
										var fortriggertt = "Triggers: " + (forpostarrivalstate==true ? "For Arrival : " : "") + (forposthrsristate==true ? "For HR SRI Request : " : "") + (forpostpredeliverystate==true ? "For Pre Delivery : " : "") +
										                 (forpostimsirequeststate==true ? "For Imsi Request : " : "") + (forpostdeliverystate==true ? "For Delivery Success PermFail : " : "") + (forpostdeliverytempfailurestate==true ? "For Delivery TempFail : " : "");

										serviceClass = 'active-service';
										
										$('#esmes-table').children('tbody').append('<tr class="service-row"><td style="vertical-align: middle; text-align: center;"><i style="color: #51A351;" class="icon-play-circle"></i></td>'+
												'<td style="cursor: pointer;" >' + id + '</td>' +
												'<td style="cursor: pointer;" >' + ruleclassname + '</td>' +
												'<td style="cursor: pointer;" data-toggle="tooltip" title="' + fortriggertt + '">' + fortrigger + '</td>' + 
												'<td style="cursor: pointer;" >' + ruleparameters + '</td>' +
												'<td style="font-size: 16px; vertical-align: middle; text-align: center; width: 150px;">' + 
													'<button class="btn btn-small btn-danger"' + ' data-toggle="tooltip" title="Remove MProc" data-placement="bottom" onclick="mprocOperation(\'destroyMProcRule\', \'' + id +  '\')"><i class="icon-remove"> </i></button> ' +
													'<a href="#entities-modal'+id+'" role="button" class="btn btn-info btn-small" data-toggle="modal"><i class="icon-external-link"></i></a>' +
												'</td></tr>'
	
	
												
										);	
										
										if(ruleclassname == "mproc"){
											
										var desttonmask = processRuleParameters(ruleparameters, "desttonmask");
										var destnpimask = processRuleParameters(ruleparameters, "destnpimask");
										var destdigmask = processRuleParameters(ruleparameters, "destdigmask");
										var sourcetonmask = processRuleParameters(ruleparameters, "sourcetonmask");
										var sourcenpimask = processRuleParameters(ruleparameters, "sourcenpimask");
										var sourcedigmask = processRuleParameters(ruleparameters, "sourcedigmask");
										var originatingmask = processRuleParameters(ruleparameters, "originatingmask");
										originatingmask = originatingmask.toUpperCase();
										var networkidmask = processRuleParameters(ruleparameters, "networkidmask");
										var originnetworkidmask = processRuleParameters(ruleparameters, "originnetworkidmask");
										var receiptnetworkidmask = processRuleParameters(ruleparameters, "receiptnetworkidmask");
										var origesmenamemask = processRuleParameters(ruleparameters, "origesmenamemask"); 
										var originatorsccpaddressmask = processRuleParameters(ruleparameters, "originatorsccpaddressmask"); 
										var imsidigitsmask = processRuleParameters(ruleparameters, "imsidigitsmask");
										var nnndigitsmask = processRuleParameters(ruleparameters, "nnndigitsmask");
										var processingtype = processRuleParameters(ruleparameters, "processingtype");
										processingtype = processingtype.toUpperCase();
										var errorcode = processRuleParameters(ruleparameters, "errorcode");
										var tlvarray = processRuleParameters(ruleparameters, "tlv");
										var tlvkey = tlvarray[0];
										var tlvtype = tlvarray[1];
										var tlvvalue =tlvarray[2];
										var percent = processRuleParameters(ruleparameters, "percent");

										var newnetworkid = processRuleParameters(ruleparameters, "newnetworkid");
										var newdestton = processRuleParameters(ruleparameters, "newdestton");
										var newdestnpi = processRuleParameters(ruleparameters, "newdestnpi");
										var adddestdigprefix = processRuleParameters(ruleparameters, "adddestdigprefix");
										var addsourcedigprefix = processRuleParameters(ruleparameters, "addsourcedigprefix");
										var newsourceton = processRuleParameters(ruleparameters, "newsourceton");
										var newsourcenpi = processRuleParameters(ruleparameters, "newsourcenpi");
										var newsourceaddr = processRuleParameters(ruleparameters, "newsourceaddr");
										var makecopy = processRuleParameters(ruleparameters, "makecopy");
										var mtlocalsccpgt = processRuleParameters(ruleparameters, "mtlocalsccpgt");
										var mtremotesccptt = processRuleParameters(ruleparameters, "mtremotesccptt");
										if(makecopy=="-1") { makecopy = "false"; }
										var hrbypass = processRuleParameters(ruleparameters, "hrbypass");
										if(hrbypass=="-1") { hrbypass = "false"; }
										var dropaftersri = processRuleParameters(ruleparameters, "dropaftersri");
										if(dropaftersri=="-1") { dropaftersri = "false"; }
										var newnetworkidaftersri = processRuleParameters(ruleparameters, "newnetworkidaftersri");
										var newnetworkidafterpermfail = processRuleParameters(ruleparameters, "newnetworkidafterpermfail");
										var dropaftertempfail = processRuleParameters(ruleparameters, "dropaftertempfail");
										if(dropaftertempfail=="-1") { dropaftertempfail = "false"; }
										var newnetworkidaftertempfail = processRuleParameters(ruleparameters, "newnetworkidaftertempfail");
										var droponarrival = processRuleParameters(ruleparameters, "droponarrival");
										if(droponarrival=="-1") { droponarrival = "false"; }
										var rejectonarrival = processRuleParameters(ruleparameters, "rejectonarrival");
										rejectonarrival = rejectonarrival.toUpperCase();
										var removetlv = processRuleParameters(ruleparameters, "tlvTagToRemove");

										$('#esmes-table-wrapper').append('<div id="entities-modal'+id+'" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">'+
												'<div class="modal-header">'+
													'<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>'+
													'<h3>Message Procesing Rule # '+id+' properties</h3>'+
												'</div>'+	
												'<div id="entities-modal-body" class="modal-body">'+
														'<div class="accordion-group">' +
															'<div class="accordion-heading">' +id+ '</div>'+
															'<div id="' + id + '" class="accordion-body">' +
																'<div class="accordion-inner">' +
																	'<strong><i class="icon-list"></i>Default Message Processing Rule</strong>' +
																	
																	'<div class="alert alert-error" id="login-settings-error" style="display:none;">'+
																	  '<button type="button" class="close">&times;</button>'+
																	  'Some Fields are not correctly filled out, please double check the settings below !'+
																	'</div>'+																			
																	
																	'<table id="'+id+'-ESME" class="table table-condensed table-striped">' + 
																		'<thead><tr><th style="width: 40%;">Name</th><th style="width: 55%;">Value</th><th>&nbsp;</th></tr></thead>' +
																		'<tbody>'+

																		'<tr>'+
																			'<td style="font-size: 0.9em;">--- Conditions ---</td>'+
																		'</tr>'+

																		'<tr data-toggle="tooltip" title="Rule will be applied only if target SMS current networkid match\'s with this rule\'s networkidmask. Set value to -1 as wild card to match all the network id\'s. Default value is -1">'+
																			'<td style="font-size: 0.9em;">Network Id Mask</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'NetworkIdMask-input" class="control-group">'+
																				'<span id="' + id +'NetworkIdMask-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + networkidmask + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'networkidmask\', \'' + id+"NetworkIdMask" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"NetworkIdMask"+']\').toggle(); $(\'input[id^='+id+"NetworkIdMask"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'NetworkIdMask-text">' + networkidmask + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"NetworkIdMask"+']\').toggle(); $(\'input[id^='+id+"NetworkIdMask"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+

																		'<tr data-toggle="tooltip" title="Rule will be applied only if SMS origination networkid match\'s with this rule\'s originnetworkidmask. Set value to -1 as wild card to match all the network id\'s. Default value is -1.">'+
																			'<td style="font-size: 0.9em;">Originating Network Id Mask</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'OriginNetworkIdMask-input" class="control-group">'+
																				'<span id="' + id +'OriginNetworkIdMask-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + originnetworkidmask + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'originnetworkidmask\', \'' + id+"OriginNetworkIdMask" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"OriginNetworkIdMask"+']\').toggle(); $(\'input[id^='+id+"OriginNetworkIdMask"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'OriginNetworkIdMask-text">' + originnetworkidmask + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"OriginNetworkIdMask"+']\').toggle(); $(\'input[id^='+id+"OriginNetworkIdMask"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+

																		'<tr data-toggle="tooltip" title="Rule will be applied only if\na) a message is a delivery receipt,\nb) the delivery receipt is recognized by SMSC GW\nc) an original message for the delivery receipt is found\nd) networkId of the original message == receiptnetworkidmask.\n Set value to -1 as wild card to match all the network id\'s. Default value is -1.">'+
																			'<td style="font-size: 0.9em;">Receipt Network Id Mask</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'receiptNetworkIdMask-input" class="control-group">'+
																				'<span id="' + id +'ReceiptNetworkIdMask-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + receiptnetworkidmask + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'receiptnetworkidmask\', \'' + id+"ReceiptNetworkIdMask" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"ReceiptNetworkIdMask"+']\').toggle(); $(\'input[id^='+id+"ReceiptNetworkIdMask"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'ReceiptNetworkIdMask-text">' + receiptnetworkidmask + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"ReceiptNetworkIdMask"+']\').toggle(); $(\'input[id^='+id+"ReceiptNetworkIdMask"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+

																			'<tr data-toggle="tooltip" title="Rule will be applied only if destination type of number (TON) of target SMS match\'s with this rule\'s desttonmask. Set value to -1 as wild card to match all the TON. Valid values of TON are &#13; 0 : Unknown &#13; 1 : International &#13; 2 : National &#13; 3 : Network Specific &#13; 4 : Subscriber &#13; 5 : Alphanumeric &#13; 6 : Abbreviated &#13; 7 : Reserved &#13; Default value is -1">'+
																				'<td style="font-size: 0.9em;">Destination Type Of Number (TON)</td>'+
																				'<td style="font-size: 0.9em; padding: 0;">'+
																					'<div id="div-' + id +'desttonmask-input" class="control-group">'+
																					'<span id="' + id +'desttonmask-input" style="display: none;">'+
																						'<input type="text" class="input-small" value="' + desttonmask + '" /> ' +
																						'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'desttonmask\', \'' + id+"desttonmask" + '\', \'true\')"></i> ' +
																						'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"desttonmask"+']\').toggle(); $(\'input[id^='+id+"desttonmask"+']\').focus();"></i>' + 
																					'</span>'+
																					'</div>' +
																					'<span id="' +id + 'desttonmask-text">' + desttonmask + '</span>'+
																				'</td>'+
																				'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"desttonmask"+']\').toggle(); $(\'input[id^='+id+"desttonmask"+']\').focus();"></i>' +
																				'</td>'+
																			'</tr>'+
																			
																			'<tr data-toggle="tooltip" title="Rule will be applied only if destination number plan indicator (NPI) of target SMS match\'s with this rule\'s destnpimask. Set value to -1 as wild card to match all the NPI. Valid values of NPI are &#13; 0  : Unknown &#13; 1  : ISDN (E163/E164) &#13; 3  : Data (X.121) &#13; 4  : Telex (F.69) &#13; 6  : Land Mobile (E.212) &#13; 8  : National &#13; 9  : Private &#13; 10 : ERMES &#13; 14 : Internet &#13; 18 : WAP Client Id &#13; Default value is -1">'+
																			'<td style="font-size: 0.9em;">Destination Number Plan Indicator (NPI)</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'DestNpiMask-input" class="control-group">'+
																				'<span id="' + id +'DestNpiMask-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + destnpimask + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'destnpimask\', \'' + id+"DestNpiMask" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"DestNpiMask"+']\').toggle(); $(\'input[id^='+id+"DestNpiMask"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'DestNpiMask-text">' + destnpimask + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"DestNpiMask"+']\').toggle(); $(\'input[id^='+id+"DestNpiMask"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+

																		'<tr data-toggle="tooltip" title="Rule will be applied only if destination number of target SMS match\'s with this rule\'s destdigmask. destdigmask is java regular expression. Set value to -1 or leave blank as wild card to match all the digits of target SMS destination. Default value is -1">'+
																			'<td style="font-size: 0.9em;">Destination Digits Mask</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'DestDigMask-input" class="control-group">'+
																				'<span id="' + id +'DestDigMask-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + destdigmask + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'destdigmask\', \'' + id+"DestDigMask" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"DestDigMask"+']\').toggle(); $(\'input[id^='+id+"DestDigMask"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'DestDigMask-text">' + destdigmask + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"DestDigMask"+']\').toggle(); $(\'input[id^='+id+"DestDigMask"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+																		

																		'<tr data-toggle="tooltip" title="Rule will be applied only if source type of number (TON) of target SMS match\'s with this rule\'s sourcetonmask. Set value to -1 as wild card to match all the TON. Valid values of TON are &#13; 0 : Unknown &#13; 1 : International &#13; 2 : National &#13; 3 : Network Specific &#13; 4 : Subscriber &#13; 5 : Alphanumeric &#13; 6 : Abbreviated &#13; 7 : Reserved &#13; Default value is -1">'+
																				'<td style="font-size: 0.9em;">Source Type Of Number (TON)</td>'+
																				'<td style="font-size: 0.9em; padding: 0;">'+
																					'<div id="div-' + id +'Sourcetonmask-input" class="control-group">'+
																					'<span id="' + id +'Sourcetonmask-input" style="display: none;">'+
																						'<input type="text" class="input-small" value="' + sourcetonmask + '" /> ' +
																						'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'sourcetonmask\', \'' + id+"Sourcetonmask" + '\', \'true\')"></i> ' +
																						'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"Sourcetonmask"+']\').toggle(); $(\'input[id^='+id+"Sourcetonmask"+']\').focus();"></i>' + 
																					'</span>'+
																					'</div>' +
																					'<span id="' +id + 'Sourcetonmask-text">' + sourcetonmask + '</span>'+
																				'</td>'+
																				'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"Sourcetonmask"+']\').toggle(); $(\'input[id^='+id+"Sourcetonmask"+']\').focus();"></i>' +
																				'</td>'+
																			'</tr>'+
																			
																			'<tr data-toggle="tooltip" title="Rule will be applied only if source number plan indicator (NPI) of target SMS match\'s with this rule\'s sourcenpimask. Set value to -1 as wild card to match all the NPI. Valid values of NPI are &#13; 0  : Unknown &#13; 1  : ISDN (E163/E164) &#13; 3  : Data (X.121) &#13; 4  : Telex (F.69) &#13; 6  : Land Mobile (E.212) &#13; 8  : National &#13; 9  : Private &#13; 10 : ERMES &#13; 14 : Internet &#13; 18 : WAP Client Id &#13; Default value is -1">'+
																			'<td style="font-size: 0.9em;">Source Number Plan Indicator (NPI)</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'SourceNpiMask-input" class="control-group">'+
																				'<span id="' + id +'SourceNpiMask-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + sourcenpimask + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'sourcenpimask\', \'' + id+"SourceNpiMask" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"SourceNpiMask"+']\').toggle(); $(\'input[id^='+id+"SourceNpiMask"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'SourceNpiMask-text">' + sourcenpimask + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"SourceNpiMask"+']\').toggle(); $(\'input[id^='+id+"SourceNpiMask"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+

																		'<tr data-toggle="tooltip" title="Rule will be applied only if source number of target SMS match\'s with this rule\'s sourcedigmask. sourcedigmask is java regular expression. Set value to -1 or leave blank as wild card to match all the digits of target SMS source. Default value is -1">'+
																			'<td style="font-size: 0.9em;">Source Digits Mask</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'SourceDigMask-input" class="control-group">'+
																				'<span id="' + id +'SourceDigMask-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + sourcedigmask + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'sourcedigmask\', \'' + id+"SourceDigMask" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"SourceDigMask"+']\').toggle(); $(\'input[id^='+id+"SourceDigMask"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'SourceDigMask-text">' + sourcedigmask + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"SourceDigMask"+']\').toggle(); $(\'input[id^='+id+"SourceDigMask"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+

																		'<tr data-toggle="tooltip" title="Rule will be applied only if IMSI digits after a successfull SRI request match\'s with this rule\'s imsidigitsmask. imsidigitsmask is java regular expression. This condition never fits if a message is not delivering to SS7 or IMSI is not obtained. Set value to null or -1 as wild card to match all the digits of IMSI. Default value is -1.">'+
																		'<td style="font-size: 0.9em;">IMSI Digits Mask</td>'+
																		'<td style="font-size: 0.9em; padding: 0;">'+
																			'<div id="div-' + id +'ImsiDigitsMask-input" class="control-group">'+
																			'<span id="' + id +'ImsiDigitsMask-input" style="display: none;">'+
																				'<input type="text" class="input-small" value="' + imsidigitsmask + '" /> ' +
																				'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'imsidigitsmask\', \'' + id+"ImsiDigitsMask" + '\', \'true\')"></i> ' +
																				'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"ImsiDigitsMask"+']\').toggle(); $(\'input[id^='+id+"ImsiDigitsMask"+']\').focus();"></i>' + 
																			'</span>'+
																			'</div>' +
																			'<span id="' +id + 'ImsiDigitsMask-text">' + imsidigitsmask + '</span>'+
																		'</td>'+
																		'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"ImsiDigitsMask"+']\').toggle(); $(\'input[id^='+id+"ImsiDigitsMask"+']\').focus();"></i>' +
																		'</td>'+
																		'</tr>'+																		
																		
																		'<tr data-toggle="tooltip" title="Rule will be applied only if NetworkNodeNumber digits (VLR address where subscriber is) after a successfull SRI request match\'s with this rule\'s nnndigitsmask. nnndigitsmask is java regular expression. This condition never fits if a message is not delivering to SS7 or NetworkNodeNumber is not obtained. Set value to null or -1 as wild card to match all the digits of NetworkNodeNumber. Default value is -1.">'+
																		'<td style="font-size: 0.9em;">NetworkNodeNumber (VLR) Digits Mask</td>'+
																		'<td style="font-size: 0.9em; padding: 0;">'+
																			'<div id="div-' + id +'NnnDigitsMask-input" class="control-group">'+
																			'<span id="' + id +'NnnDigitsMask-input" style="display: none;">'+
																				'<input type="text" class="input-small" value="' + nnndigitsmask + '" /> ' +
																				'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'nnndigitsmask\', \'' + id+"NnnDigitsMask" + '\', \'true\')"></i> ' +
																				'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"NnnDigitsMask"+']\').toggle(); $(\'input[id^='+id+"NnnDigitsMask"+']\').focus();"></i>' + 
																			'</span>'+
																			'</div>' +
																			'<span id="' +id + 'NnnDigitsMask-text">' + nnndigitsmask + '</span>'+
																		'</td>'+
																		'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"NnnDigitsMask"+']\').toggle(); $(\'input[id^='+id+"NnnDigitsMask"+']\').focus();"></i>' +
																		'</td>'+
																		'</tr>'+																		

																		'<tr data-toggle="tooltip" title="Rule will be applied only if target SMS is originated from channel as specified by originatingmask. Leave blank as wild card to match all the origination type. Valid values are &#13; SMPP &#13; SS7_MO &#13; SS7_HR &#13; SIP &#13; HTTP &#13; Default is blank">'+
																			'<td style="font-size: 0.9em;">Originating Channel</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'OriginatingMask-input" class="control-group">'+
																				'<span id="' + id +'OriginatingMask-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + originatingmask + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'originatingmask\', \'' + id+"OriginatingMask" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"OriginatingMask"+']\').toggle(); $(\'input[id^='+id+"OriginatingMask"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'OriginatingMask-text">' + originatingmask + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"OriginatingMask"+']\').toggle(); $(\'input[id^='+id+"OriginatingMask"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+	

																		'<tr data-toggle="tooltip" title="Rule will be applied only if target SMS is originated from SMPP channel (ESME) and who\'s name match\'s with originating ESME name mask (Java Regular Expression). Set -1 as wild card to match all the ESME.">'+
																			'<td style="font-size: 0.9em;">Originating ESME Name Mask</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'OrigEsmeNameMask-input" class="control-group">'+
																				'<span id="' + id +'OrigEsmeNameMask-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + origesmenamemask + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'origesmenamemask\', \'' + id+"OrigEsmeNameMask" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"OrigEsmeNameMask"+']\').toggle(); $(\'input[id^='+id+"OrigEsmeNameMask"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'OrigEsmeNameMask-text">' + origesmenamemask + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"OrigEsmeNameMask"+']\').toggle(); $(\'input[id^='+id+"OrigEsmeNameMask"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="Rule will be applied only if SCCP CallingPartyAddress digits match\'s with this rule\'s originatorsccpaddressmask. originatorsccpaddressmask is java regular expression. Set value to null or -1 as wild card to match all the digits of CallingPartyAddress digits. Default value is -1">'+
																		'<td style="font-size: 0.9em;">Originating (CallingPartyAddress) SCCP Digit Mask</td>'+
																		'<td style="font-size: 0.9em; padding: 0;">'+
																			'<div id="div-' + id +'OriginatorSccpAddressMask-input" class="control-group">'+
																			'<span id="' + id +'OriginatorSccpAddressMask-input" style="display: none;">'+
																				'<input type="text" class="input-small" value="' + originatorsccpaddressmask + '" /> ' +
																				'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'originatorsccpaddressmask\', \'' + id+"OriginatorSccpAddressMask" + '\', \'true\')"></i> ' +
																				'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"OriginatorSccpAddressMask"+']\').toggle(); $(\'input[id^='+id+"OriginatorSccpAddressMask"+']\').focus();"></i>' + 
																			'</span>'+
																			'</div>' +
																			'<span id="' +id + 'OriginatorSccpAddressMask-text">' + originatorsccpaddressmask + '</span>'+
																		'</td>'+
																		'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"OriginatorSccpAddressMask"+']\').toggle(); $(\'input[id^='+id+"OriginatorSccpAddressMask"+']\').focus();"></i>' +
																		'</td>'+
																		'</tr>'+																		

																		'<tr data-toggle="tooltip" title="Rule will be applied only if a Delivery step match\'s with this rule\'s processingtype. Value -1 will match all steps. Default value is -1. Possible values are:&#13;SMPP - delivery via SMPP channel&#13;SS7_SRI - sending of SRI request to HLR&#13;SS7_MT - MT delivery to SS7 network&#13;SIP - delivery via SIP channel">'+
																		'<td style="font-size: 0.9em;">Delivery step</td>'+
																		'<td style="font-size: 0.9em; padding: 0;">'+
																			'<div id="div-' + id +'ProcessingType-input" class="control-group">'+
																			'<span id="' + id +'ProcessingType-input" style="display: none;">'+
																				'<input type="text" class="input-small" value="' + processingtype + '" /> ' +
																				'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'processingtype\', \'' + id+"ProcessingType" + '\', \'true\')"></i> ' +
																				'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"ProcessingType"+']\').toggle(); $(\'input[id^='+id+"ProcessingType"+']\').focus();"></i>' + 
																			'</span>'+
																			'</div>' +
																			'<span id="' +id + 'ProcessingType-text">' + processingtype + '</span>'+
																		'</td>'+
																		'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"ProcessingType"+']\').toggle(); $(\'input[id^='+id+"ProcessingType"+']\').focus();"></i>' +
																		'</td>'+
																		'</tr>'+																		
																		
																		'<tr data-toggle="tooltip" title="Rule will be applied only if an internal SMSC GW delivery error code value match\'s with this rule\'s errorcode. Value 0 means a successful delivery, non 0 value means some delivery error. You can specify several values via comma (example: &#34;6,7,8&#34;). Value -1 will match any error code. Default value is -1.">'+
																		'<td style="font-size: 0.9em;">Delivery error code value</td>'+
																		'<td style="font-size: 0.9em; padding: 0;">'+
																			'<div id="div-' + id +'ErrorCode-input" class="control-group">'+
																			'<span id="' + id +'ErrorCode-input" style="display: none;">'+
																				'<input type="text" class="input-small" value="' + errorcode + '" /> ' +
																				'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'errorcode\', \'' + id+"ErrorCode" + '\', \'true\')"></i> ' +
																				'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"ErrorCode"+']\').toggle(); $(\'input[id^='+id+"ErrorCode"+']\').focus();"></i>' + 
																			'</span>'+
																			'</div>' +
																			'<span id="' +id + 'ErrorCode-text">' + errorcode + '</span>'+
																		'</td>'+
																		'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"ErrorCode"+']\').toggle(); $(\'input[id^='+id+"ErrorCode"+']\').focus();"></i>' +
																		'</td>'+
																		'</tr>'+

																		'<tr data-toggle="tooltip" title="Rule will be applied only if message contains an optional parameter with tag equalling &lt;tag key&gt; and has a tag value with a type which equals the &lt;value type&gt; and a value which equals the value set here. Value -1 will match any optional parameter. Possible values for &lt;value type&gt; are &#13; string &#13; int &#13; byte &#13;Default value for &lt;tag key&gt; is -1. Default value for &lt;value type&gt; is string. Default value for &lt;tag value&gt; is -1.">'+
																		'<td style="font-size: 0.9em;">Tlv To Match</td>'+
																		'<td style="font-size: 0.9em; padding: 0;">'+
																			'<div id="div-' + id +'TlvKey-input" class="control-group">'+
																			'<span id="' + id +'TlvKey-input" style="display: none;">'+
																				'<input type="text" class="input-small" value="' + tlvkey + '" /> ' +
																				'<input type="text" class="input-small" value="' + tlvtype + '" /> ' +
																				'<input type="text" class="input-small" value="' + tlvvalue + '" /> ' +
																				'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'tlv_'+tlvtype+'_'+tlvkey +'\', \'' + id+"TlvKey" + '\', \'true\')"></i> ' +
																				'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"TlvKey"+']\').toggle(); $(\'input[id^='+id+"TlvKey"+']\').focus();"></i>' +
																			'</span>'+
																			'</div>' +
																			'<span id="' +id + 'TlvKey-text">' + tlvkey +' '+tlvtype+' '+tlvvalue+ '</span>'+
																		'</td>'+
																		'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"TlvKey"+']\').toggle(); $(\'input[id^='+id+"TlvKey"+']\').focus();"></i>' +
																		'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="Defines probability with which mproc rule will be applied to a message. Default value -1 means that mproc rule will be applied to 100% of messages.">'+
																		'<td style="font-size: 0.9em;">Percent</td>'+
																		'<td style="font-size: 0.9em; padding: 0;">'+
																			'<div id="div-' + id +'Percent-input" class="control-group">'+
																			'<span id="' + id +'Percent-input" style="display: none;">'+
																				'<input type="text" class="input-small" value="' + percent + '" /> ' +
																				'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'percent\', \'' + id+"Percent" + '\', \'true\')"></i> ' +
																				'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"Percent"+']\').toggle(); $(\'input[id^='+id+"Percent"+']\').focus();"></i>' + 
																			'</span>'+
																			'</div>' +
																			'<span id="' +id + 'Percent-text">' + percent + '</span>'+
																		'</td>'+
																		'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"Percent"+']\').toggle(); $(\'input[id^='+id+"Percent"+']\').focus();"></i>' +
																		'</td>'+
																		'</tr>'+
																		
																		'<tr>'+
																			'<td style="font-size: 0.9em;">--- Actions ---</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="Once rule match\'s, the target SMS\'s network id will be change to one set here. This will allow to received SMS from different network and terminate on different network. Set this to -1 to keep original network id. Default value is -1.">'+
																			'<td style="font-size: 0.9em;">New Network Id</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'NewNetworkId-input" class="control-group">'+
																				'<span id="' + id +'NewNetworkId-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + newnetworkid + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'newnetworkid\', \'' + id+"NewNetworkId" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewNetworkId"+']\').toggle(); $(\'input[id^='+id+"NewNetworkId"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'NewNetworkId-text">' + newnetworkid + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewNetworkId"+']\').toggle(); $(\'input[id^='+id+"NewNetworkId"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="Once rule match\'s, the target SMS\'s destination type of number(TON) will be changed to one set here. Set this to -1 to keep original TON. Default value is -1. Valid values of TON are &#13; 0 : Unknown &#13; 1 : International &#13; 2 : National &#13; 3 : Network Specific &#13; 4 : Subscriber &#13; 5 : Alphanumeric &#13; 6 : Abbreviated &#13; 7 : Reserved &#13;">'+
																			'<td style="font-size: 0.9em;">New Destination Ton</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'NewDestTon-input" class="control-group">'+
																				'<span id="' + id +'NewDestTon-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + newdestton + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'newdestton\', \'' + id+"NewDestTon" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewDestTon"+']\').toggle(); $(\'input[id^='+id+"NewDestTon"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'NewDestTon-text">' + newdestton + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewDestTon"+']\').toggle(); $(\'input[id^='+id+"NewDestTon"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="Once rule match\'s, the target SMS\'s destination number plan indicator (NPI) will be changed to one set here. Set this to -1 to keep original NPI. Default value is -1. Valid values of NPI are &#13; 0  : Unknown &#13; 1  : ISDN (E163/E164) &#13; 3  : Data (X.121) &#13; 4  : Telex (F.69) &#13; 6  : Land Mobile (E.212) &#13; 8  : National &#13; 9  : Private &#13; 10 : ERMES &#13; 14 : Internet &#13; 18 : WAP Client Id &#13;">'+
																			'<td style="font-size: 0.9em;">New Destination Npi</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'NewDestNpi-input" class="control-group">'+
																				'<span id="' + id +'NewDestNpi-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + newdestnpi + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'newdestnpi\', \'' + id+"NewDestNpi" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewDestNpi"+']\').toggle(); $(\'input[id^='+id+"NewDestNpi"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'NewDestNpi-text">' + newdestnpi + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewDestNpi"+']\').toggle(); $(\'input[id^='+id+"NewDestNpi"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+

																		'<tr data-toggle="tooltip" title="Once rule match\'s, the target SMS\'s destination number will be prefixed with adddestdigprefix set here. Set this to -1 or leave blank to keep original destination number. Default value is -1.">'+
																			'<td style="font-size: 0.9em;">Destination Digits Prefix</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'AddDestDigPrefix-input" class="control-group">'+
																				'<span id="' + id +'AddDestDigPrefix-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + adddestdigprefix + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'adddestdigprefix\', \'' + id+"AddDestDigPrefix" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"AddDestDigPrefix"+']\').toggle(); $(\'input[id^='+id+"AddDestDigPrefix"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'AddDestDigPrefix-text">' + adddestdigprefix + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"AddDestDigPrefix"+']\').toggle(); $(\'input[id^='+id+"AddDestDigPrefix"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+

																		'<tr data-toggle="tooltip" title="Once rule match\'s, the target SMS\'s source number will be prefixed with addsourcedigprefix set here. Set this to -1 or leave blank to keep original source number. Default value is -1.">'+
																			'<td style="font-size: 0.9em;">Source Digits Prefix</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'AddSourceDigPrefix-input" class="control-group">'+
																				'<span id="' + id +'AddSourceDigPrefix-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + addsourcedigprefix + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'addsourcedigprefix\', \'' + id+"AddSourceDigPrefix" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"AddSourceDigPrefix"+']\').toggle(); $(\'input[id^='+id+"AddSourceDigPrefix"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'AddSourceDigPrefix-text">' + addsourcedigprefix + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"AddSourceDigPrefix"+']\').toggle(); $(\'input[id^='+id+"AddSourceDigPrefix"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+

																		'<tr data-toggle="tooltip" title="Once rule match\'s, the target SMS\'s source type of number(TON) will be changed to one set here. Set this to -1 to keep original TON. Default value is -1. Valid values of TON are &#13; 0 : Unknown &#13; 1 : International &#13; 2 : National &#13; 3 : Network Specific &#13; 4 : Subscriber &#13; 5 : Alphanumeric &#13; 6 : Abbreviated &#13; 7 : Reserved &#13;">'+
																			'<td style="font-size: 0.9em;">New Source Ton</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'NewSourceTon-input" class="control-group">'+
																				'<span id="' + id +'NewSourceTon-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + newsourceton + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'newsourceton\', \'' + id+"NewSourceTon" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewSourceTon"+']\').toggle(); $(\'input[id^='+id+"NewSourceTon"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'NewSourceTon-text">' + newsourceton + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewSourceTon"+']\').toggle(); $(\'input[id^='+id+"NewSourceTon"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="Once rule match\'s, the target SMS\'s source number plan indicator (NPI) will be changed to one set here. Set this to -1 to keep original NPI. Default value is -1. Valid values of NPI are &#13; 0  : Unknown &#13; 1  : ISDN (E163/E164) &#13; 3  : Data (X.121) &#13; 4  : Telex (F.69) &#13; 6  : Land Mobile (E.212) &#13; 8  : National &#13; 9  : Private &#13; 10 : ERMES &#13; 14 : Internet &#13; 18 : WAP Client Id &#13;">'+
																			'<td style="font-size: 0.9em;">New Source Npi</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'NewSourceNpi-input" class="control-group">'+
																				'<span id="' + id +'NewSourceNpi-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + newsourcenpi + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'newsourcenpi\', \'' + id+"NewSourceNpi" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewSourceNpi"+']\').toggle(); $(\'input[id^='+id+"NewSourceNpi"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'NewSourceNpi-text">' + newsourcenpi + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewSourceNpi"+']\').toggle(); $(\'input[id^='+id+"NewSourceNpi"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="Once rule match\'s, the target SMS\'s source number will be changed to one set here. Set this to -1 or leave blank to keep original source number. Dfault value is -1.">'+
																			'<td style="font-size: 0.9em;">New Source Address</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'NewSourceAddr-input" class="control-group">'+
																				'<span id="' + id +'NewSourceAddr-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + newsourceaddr + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'newsourceaddr\', \'' + id+"NewSourceAddr" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewSourceAddr"+']\').toggle(); $(\'input[id^='+id+"NewSourceAddr"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'NewSourceAddr-text">' + newsourceaddr + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewSourceAddr"+']\').toggle(); $(\'input[id^='+id+"NewSourceAddr"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="Once rule matches, the target SMS\'s destination global title (GT) will be changed to one set with this command. Set this to -1 to keep original GT. Default value is -1.">'+
																			'<td style="font-size: 0.9em;">New GT for local SCCP address of MT message</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'mtlocalsccpgt-input" class="control-group">'+
																				'<span id="' + id +'mtlocalsccpgt-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + mtlocalsccpgt + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'mtlocalsccpgt\', \'' + id+"mtlocalsccpgt" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"mtlocalsccpgt"+']\').toggle(); $(\'input[id^='+id+"mtlocalsccpgt"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'mtlocalsccpgt-text">' + mtlocalsccpgt + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"mtlocalsccpgt"+']\').toggle(); $(\'input[id^='+id+"mtlocalsccpgt"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="Once rule matches, the target SMS\'s destination translation type (TT) will be changed to one set with this command. Set this to -1 to keep original TT. Default value is -1.">'+
																			'<td style="font-size: 0.9em;">New TT for remote SCCP address of MT message</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'mtremotesccptt-input" class="control-group">'+
																				'<span id="' + id +'mtremotesccptt-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + mtremotesccptt + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'mtremotesccptt\', \'' + id+"mtremotesccptt" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"mtremotesccptt"+']\').toggle(); $(\'input[id^='+id+"mtremotesccptt"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'mtremotesccptt-text">' + mtremotesccptt + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"mtremotesccptt"+']\').toggle(); $(\'input[id^='+id+"mtremotesccptt"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="Once rule match\'s, and makecopy is set to true, a new copy of SMS is created. If new SMS is created all above parameters like networkidmask, newnetworkid, newdestton, newdestnpi, adddestdigprefix, newsourceton, newsourcenpi, newsourceaddr will be applied to new SMS">'+
																			'<td style="font-size: 0.9em;">Make Copy</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'MakeCopy-input" class="control-group">'+
																				'<span id="' + id +'MakeCopy-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + makecopy + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'makecopy\', \'' + id+"MakeCopy" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"MakeCopy"+']\').toggle(); $(\'input[id^='+id+"MakeCopy"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'MakeCopy-text">' + makecopy + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"MakeCopy"+']\').toggle(); $(\'input[id^='+id+"MakeCopy"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="Once rule match\'s inside Home Routing procedure after SMSC GW receives a response from a local HLR then SMSC GW will bypass HR procedure by sending back to an original SMSC GW origin original IMSI and NNN.">'+
																			'<td style="font-size: 0.9em;">ByPass HR procedure after SRI to a local HLR</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'HrByPass-input" class="control-group">'+
																				'<span id="' + id +'HrByPass-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + hrbypass + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'hrbypass\', \'' + id+"HrByPass" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"HrByPass"+']\').toggle(); $(\'input[id^='+id+"HrByPass"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'HrByPass-text">' + hrbypass + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"HrByPass"+']\').toggle(); $(\'input[id^='+id+"HrByPass"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+																		
																		
																		'<tr data-toggle="tooltip" title="Once rule match\'s and if a MAP SRI success response is received, message will be dropped without delivery attempt. A delivery response in this case will contain extra fields (IMSI and NetworkNodeNumber values). This action is applied only for SMS that are attempted to be delivered to SS7 network.">'+
																			'<td style="font-size: 0.9em;">Drop after MAP SRI Request</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'DropAfterSri-input" class="control-group">'+
																				'<span id="' + id +'DropAfterSri-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + dropaftersri + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'dropaftersri\', \'' + id+"DropAfterSri" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"DropAfterSri"+']\').toggle(); $(\'input[id^='+id+"DropAfterSri"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'DropAfterSri-text">' + dropaftersri + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"DropAfterSri"+']\').toggle(); $(\'input[id^='+id+"DropAfterSri"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+																		

																		'<tr data-toggle="tooltip" title="Once rule match\'s and if a MAP SRI success response is received, message will be rerouted for delivery to another networkId. This action is applied only for SMS that are attempted to be delivered to SS7 network.">'+
																			'<td style="font-size: 0.9em;">Reroute after MAP SRI Request</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'NewNetworkIdAfterSri-input" class="control-group">'+
																				'<span id="' + id +'NewNetworkIdAfterSri-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + newnetworkidaftersri + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'newnetworkidaftersri\', \'' + id+"NewNetworkIdAfterSri" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewNetworkIdAfterSri"+']\').toggle(); $(\'input[id^='+id+"NewNetworkIdAfterSri"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'NewNetworkIdAfterSri-text">' + newnetworkidaftersri + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewNetworkIdAfterSri"+']\').toggle(); $(\'input[id^='+id+"NewNetworkIdAfterSri"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+																		
																		
																		'<tr data-toggle="tooltip" title="Once rule match\'s and if a message delivery has failed permanently, message will be rerouted for delivery to another networkId.">'+
																			'<td style="font-size: 0.9em;">Reroute after permanent failure</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'NewNetworkIdAfterPermFail-input" class="control-group">'+
																				'<span id="' + id +'NewNetworkIdAfterPermFail-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + newnetworkidafterpermfail + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'newnetworkidafterpermfail\', \'' + id+"NewNetworkIdAfterPermFail" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewNetworkIdAfterPermFail"+']\').toggle(); $(\'input[id^='+id+"NewNetworkIdAfterPermFail"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'NewNetworkIdAfterPermFail-text">' + newnetworkidafterpermfail + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewNetworkIdAfterPermFail"+']\').toggle(); $(\'input[id^='+id+"NewNetworkIdAfterPermFail"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+																		
																		
																		'<tr data-toggle="tooltip" title="Once rule match\'s and if a message delivery has failed temporary, message will be dropped without any new delivery attempts.">'+
																			'<td style="font-size: 0.9em;">Drop after temporary failure</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'DropAfterTempFail-input" class="control-group">'+
																				'<span id="' + id +'DropAfterTempFail-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + dropaftertempfail + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'dropaftertempfail\', \'' + id+"DropAfterTempFail" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"DropAfterTempFail"+']\').toggle(); $(\'input[id^='+id+"DropAfterTempFail"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'DropAfterTempFail-text">' + dropaftertempfail + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"DropAfterTempFail"+']\').toggle(); $(\'input[id^='+id+"DropAfterTempFail"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+																		
																		
																		'<tr data-toggle="tooltip" title="Once rule match\'s and if a message delivery has failed temporary, message will be rerouted for delivery to another networkId.">'+
																			'<td style="font-size: 0.9em;">Reroute after temporary failure</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'NewNetworkIdAfterTempFail-input" class="control-group">'+
																				'<span id="' + id +'NewNetworkIdAfterTempFail-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + newnetworkidaftertempfail + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'newnetworkidaftertempfail\', \'' + id+"NewNetworkIdAfterTempFail" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewNetworkIdAfterTempFail"+']\').toggle(); $(\'input[id^='+id+"NewNetworkIdAfterTempFail"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'NewNetworkIdAfterTempFail-text">' + newnetworkidaftertempfail + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"NewNetworkIdAfterTempFail"+']\').toggle(); $(\'input[id^='+id+"NewNetworkIdAfterTempFail"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="This action is performed at the step when message has arrived to the server. Message will be dropped without delivery attempt and success response will be returned to a sender.">'+
																			'<td style="font-size: 0.9em;">Drop upon arrival to the server</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'DropOnArrival-input" class="control-group">'+
																				'<span id="' + id +'DropOnArrival-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + droponarrival + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'droponarrival\', \'' + id+"DropOnArrival" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"DropOnArrival"+']\').toggle(); $(\'input[id^='+id+"DropOnArrival"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'DropOnArrival-text">' + dropaftersri + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"DropOnArrival"+']\').toggle(); $(\'input[id^='+id+"DropOnArrival"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+
																		
																		'<tr data-toggle="tooltip" title="This action is performed at the step when message has arrived to the server. Set this to -1 or leave blank to remove the action. If value is NONE, no action will be performed. Otherwise message will be rejected without delivery attempt and reject response will be returned to a sender. Valid values for rejectOnArrival are: &#13;NONE, &#13;DEFAULT, &#13;UNEXPECTED_DATA_VALUE, &#13;SYSTEM_FAILURE, &#13;THROTTLING, &#13;FACILITY_NOT_SUPPORTED">'+
																			'<td style="font-size: 0.9em;">Reject upon arrival to the server</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'RejectOnArrival-input" class="control-group">'+
																				'<span id="' + id +'RejectOnArrival-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + rejectonarrival + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'rejectonarrival\', \'' + id+"RejectOnArrival" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"RejectOnArrival"+']\').toggle(); $(\'input[id^='+id+"RejectOnArrival"+']\').focus();"></i>' + 
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'RejectOnArrival-text">' + rejectonarrival + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"RejectOnArrival"+']\').toggle(); $(\'input[id^='+id+"RejectOnArrival"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+

																		'<tr data-toggle="tooltip" title="Once rule matches, the target SMS\'s optional parameter which matches the one set here will be removed. Set this to -1 to not remove any optional parameter. Default value is -1.">'+
																			'<td style="font-size: 0.9em;">Remove Tlv</td>'+
																			'<td style="font-size: 0.9em; padding: 0;">'+
																				'<div id="div-' + id +'RemoveTlv-input" class="control-group">'+
																				'<span id="' + id +'RemoveTlv-input" style="display: none;">'+
																					'<input type="text" class="input-small" value="' + removetlv + '" /> ' +
																					'<i class="icon-ok" style="cursor: pointer;" onclick="onModifyEsmeOk(\'' + id+ '\', \'remove_tlv\', \'' + id+"RemoveTlv" + '\', \'true\')"></i> ' +
																					'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"RemoveTlv"+']\').toggle(); $(\'input[id^='+id+"RemoveTlv"+']\').focus();"></i>' +
																				'</span>'+
																				'</div>' +
																				'<span id="' +id + 'RemoveTlv-text">' + removetlv + '</span>'+
																			'</td>'+
																			'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"RemoveTlv"+']\').toggle(); $(\'input[id^='+id+"RemoveTlv"+']\').focus();"></i>' +
																			'</td>'+
																		'</tr>'+





																		
																		'</tbody>' +
																	'</table>' +	
																	
																'</div>'+
															'</div>'+
														'</div>'+
												'</div>'+
												'<div class="modal-footer">'+
													'<a href="#" onclick="$(\'#entities-modal'+id+'\').modal(\'hide\'); return false;" class="btn">Close</a>'+
												'</div>'+										
											'</div>');	
										} else {
											var classname = value.ruleClassName;
											$('#esmes-table-wrapper').append('<div id="entities-modal'+id+'" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">'+
													'<div class="modal-header">'+
														'<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>'+
														'<h3>Message Procesing Rule # '+id+' properties</h3>'+
													'</div>'+	
													'<div id="entities-modal-body" class="modal-body">'+
															'<div class="accordion-group">' +
																'<div class="accordion-heading">' +id+ '</div>'+
																'<div id="' + id + '" class="accordion-body">' +
																	'<div class="accordion-inner">' +
																		'<strong><i class="icon-list"></i>Custom Message Processing Rule</strong>' +
																		
																		'<div class="alert alert-error" id="login-settings-error" style="display:none;">'+
																		  '<button type="button" class="close">&times;</button>'+
																		  'Some Fields are not correctly filled out, please double check the settings below !'+
																		'</div>'+																			
																		
																		'<table id="'+id+'-ESME" class="table table-condensed table-striped">' + 
																			'<thead><tr><th style="width: 40%;">Name</th><th style="width: 55%;">Value</th><th>&nbsp;</th></tr></thead>' +
																			'<tbody>'+
																			
																				'<tr data-toggle="tooltip" title="Name of a class for a mproc rule">'+
																					'<td style="font-size: 0.9em;">Class Name</td>'+
																					'<td style="font-size: 0.9em; padding: 0;">'+
																						'<span id="' +id + 'classname-text">' + classname + '</span>'+
																					'</td>'+
																					'<td> &nbsp;' +
																					'</td>'+
																				'</tr>'+
																				
																				'<tr data-toggle="tooltip" title="Parameters list for a mproc rule">'+
																				'<td style="font-size: 0.9em;">Rule Parameters</td>'+
																				'<td style="font-size: 0.9em; padding: 0;">'+
																					'<div id="div-' + id +'RuleParameters-input" class="control-group">'+
																					'<span id="' + id +'RuleParameters-input" style="display: none;">'+
																						'<input type="text" class="input-mini" style="width: 320px; margin-right: 12px;" value="' + ruleparameters + '" /> ' +
																						'<i class="icon-ok" style="cursor: pointer;" onclick="onCustomModifyEsmeOk(\'' + id+ '\', \'ruleparameters\', \'' + id+"RuleParameters" + '\', \'true\')"></i> ' +
																						'<i class="icon-remove" style="cursor: pointer;" onclick="$(\'[id^='+id+"RuleParameters"+']\').toggle(); $(\'input[id^='+id+"RuleParameters"+']\').focus();"></i>' + 
																					'</span>'+
																					'</div>' +
																					'<span id="' +id + 'RuleParameters-text">' + ruleparameters + '</span>'+
																				'</td>'+
																				'<td><i class="icon-pencil" data-toggle="tooltip" title="Edit" style="cursor: pointer;" onclick="$(\'[id^='+id+"RuleParameters"+']\').toggle(); $(\'input[id^='+id+"RuleParameters"+']\').focus();"></i>' +
																				'</td>'+
																			'</tr>'+																				
																			'</tbody>' +
																		'</table>' +	
																	'</div>'+
																'</div>'+
															'</div>'+
													'</div>'+
													'<div class="modal-footer">'+
														'<a href="#" onclick="$(\'#entities-modal'+id+'\').modal(\'hide\'); return false;" class="btn">Close</a>'+
													'</div>'+										
												'</div>');											
											
										}
										
										
									});
									
									if(noOfMProcRules == 0){
										$('#no-esmes-table').show();
										$('#esmes-table').hide();
									}else {
										$('#no-esmes-table'+name).hide();
										$('#esmes-table').show();
									}
								}],
								error: function(value){
									errorUID = ("st" + new Date().getTime()).hashCode();
									createStackTrace(errorUID, value.stacktrace);
									logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
								}
							}
						); 

				});
			}
		})
		.fail(function() {
			logToConsole("ERROR", "Failure trying to communicate with the SMSC Gateway. Please try again later.");
		})
	}
	
	function mprocOperation(operation, name) {
		mbeanSearch="org.mobicents.smsc:layer=MProcManagement,name=SmscManagement";
		jolokia.execute(mbeanSearch,operation,name,
				{
					success: function(value) {
						updateMProc();
						logToConsole('INFO', 'Successfully '+operation+' ' + name );
					},
					error: function(value){
						errorUID = ("st" + new Date().getTime()).hashCode();
						createStackTrace(errorUID, value.stacktrace);
						logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
					}
				});	
		
	}
	
	function createMProcCustom(){
		var formInvalid = false;
		var focusNotSet = true;
		
		var parametersstring = "";
		
		var id = $("#id-custom").val();
		if(id.trim() == "") {
			$("#div-id-custom").addClass("error");
			if(focusNotSet){
				$("#id-custom").focus();
				focusNotSet = false;
			}
			formInvalid = true;
		} else if($("#div-id-custom").hasClass("error")) {
			$("#div-id-custom").removeClass("error");		
		}
		
		var ruleclassname = $("#classname-custom").val();
		if(ruleclassname.trim() == "") {
			$("#div-classname-custom").addClass("error");
			if(focusNotSet){
				$("#classname-custom").focus();
				focusNotSet = false;
			}
			formInvalid = true;
		} else if($("#div-classname-custom").hasClass("error")) {
			$("#div-classname-custom").removeClass("error");		
		}
		
		var parametersstring = $("#parameters-custom").val();
		if(parametersstring.trim() == "") {
			parametersstring = null;
		} else {
			parametersstring = parametersstring.trim();	
		}	
		
		if(formInvalid) {
			$("#login-settings-error").show();
			logToConsole("ERROR", "Some Fields are not correctly filled out, please double check the settings !");
			return false;
		} else {
			$("#login-settings-error").hide();
		}
		
		jolokia.execute("org.mobicents.smsc:layer=MProcManagement,name=SmscManagement","createMProcRule", id,ruleclassname,parametersstring, 
				{
					success: function(value) {
						updateMProc();
						logToConsole('INFO', 'MProc rule ' + id + ' created successfuly.');
						$('#entities-modal-custom').modal('hide');
					},
					error: function(value){
						errorUID = ("st" + new Date().getTime()).hashCode();
						createStackTrace(errorUID, value.stacktrace);
						logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
					}					
				});		
		
	}	
	
	function createMProc(){
		var formInvalid = false;
		var focusNotSet = true;
		
		var parametersstring = "";
		
		var id = $("#id").val();
		if(id.trim() == "") {
			$("#div-id").addClass("error");
			if(focusNotSet){
				$("#id").focus();
				focusNotSet = false;
			}
			formInvalid = true;
		} else if($("#div-id").hasClass("error")) {
			$("#div-id").removeClass("error");		
		}
		
		var e = document.getElementById("desttonmask");
		if(e.selectedIndex != -1){
			var desttonmask = e.options[e.selectedIndex].value;
			parametersstring = parametersstring + " desttonmask "+desttonmask;
		}
		
		e = document.getElementById("destnpimask");
		if(e.selectedIndex != -1){
			var destnpimask = e.options[e.selectedIndex].value;
			parametersstring = parametersstring + " destnpimask "+destnpimask;
		}
		
		var destdigmask = $("#destdigmask").val();
		if(destdigmask.trim() == "") {
			destdigmask = null;		
		} else {
			parametersstring = parametersstring + " destdigmask "+destdigmask;
		}
		
		var e = document.getElementById("sourcetonmask");
		if(e.selectedIndex != -1){
			var sourcetonmask = e.options[e.selectedIndex].value;
			parametersstring = parametersstring + " sourcetonmask "+sourcetonmask;
		}
		
		e = document.getElementById("sourcenpimask");
		if(e.selectedIndex != -1){
			var sourcenpimask = e.options[e.selectedIndex].value;
			parametersstring = parametersstring + " sourcenpimask "+sourcenpimask;
		}
		
		var sourcedigmask = $("#sourcedigmask").val();
		if(sourcedigmask.trim() == "") {
			sourcedigmask = null;		
		} else {
			parametersstring = parametersstring + " sourcedigmask "+sourcedigmask;
		}

		e = document.getElementById("originatingmask");
		var originatingmask = e.options[e.selectedIndex].value;
		if(originatingmask == "All") {
			originatingmask = null;		
		} else {
			parametersstring = parametersstring + " originatingmask "+originatingmask;
		}
		
		var origesmenamemask = $("#origesmenamemask").val();
		if(origesmenamemask.trim() == "") {
			origesmenamemask = null;		
		} else {
			parametersstring = parametersstring + " origesmenamemask "+origesmenamemask;
		}
		
		var originatorsccpaddressmask = $("#originatorsccpaddressmask").val();
		if(originatorsccpaddressmask.trim() == "") {
			originatorsccpaddressmask = null;		
		} else {
			parametersstring = parametersstring + " originatorsccpaddressmask "+originatorsccpaddressmask;
		}		
		
		var networkidmask = $("#networkidmask").val();
		if(networkidmask.trim() == "") {
			networkidmask = "-1";
		} else {
			parametersstring = parametersstring + " networkidmask "+networkidmask;
		}

		var imsidigitsmask = $("#imsidigitsmask").val();
		if(imsidigitsmask.trim() == "") {
			imsidigitsmask = null;		
		} else {
			parametersstring = parametersstring + " imsidigitsmask "+imsidigitsmask;
		}
		
		var nnndigitsmask = $("#nnndigitsmask").val();

		if(nnndigitsmask.trim() == "") {
			nnndigitsmask = null;		
		} else {
			parametersstring = parametersstring + " nnndigitsmask "+nnndigitsmask;
		}
		
		e = document.getElementById("processingtype");
		var processingtype = e.options[e.selectedIndex].value;
		if(processingtype == "All") {
			processingtype = null;		
		} else {
			parametersstring = parametersstring + " processingtype "+processingtype;
		}
		
		var originnetworkidmask = $("#originnetworkidmask").val();
		if(originnetworkidmask.trim() == "") {
			originnetworkidmask = "-1";
		} else {
			parametersstring = parametersstring + " originnetworkidmask "+originnetworkidmask;
		}

		var receiptnetworkidmask = $("#receiptnetworkidmask").val();
		if(receiptnetworkidmask.trim() == "") {
			receiptnetworkidmask = "-1";
		} else {
			parametersstring = parametersstring + " receiptnetworkidmask "+receiptnetworkidmask;
		}
		
		var errorcode = $("#errorcode").val();
		if(errorcode.trim() == "") {
			errorcode = "-1";
		} else {
			parametersstring = parametersstring + " errorcode "+errorcode;
		}

		var tlvkey = $("#tlvkey").val();
		e = document.getElementById("tlvtype");
		var tlvtype = e.options[e.selectedIndex].value;
		var tlvvalue = $("#tlvvalue").val();

		if(tlvkey.trim() == "" ||
		   tlvvalue.trim() == "") {
			tlvkey = "-1";
			tlvtype = "string";
			tlvvalue = "-1";
		} else {
			parametersstring = parametersstring + " tlv_"+tlvtype+"_"+tlvkey+" "+tlvvalue;
		}
		
		var percent = $("#percent").val();
		if(percent.trim() == "") {
			percent = "-1";
		} else {
			parametersstring = parametersstring + " percent "+percent;
		}
		
		var newnetworkid = $("#newnetworkid").val();
		if(newnetworkid.trim() == "") {
			newnetworkid = "-1";
		} else {
			parametersstring = parametersstring + " newnetworkid "+newnetworkid;
		}
		
		var e = document.getElementById("newdestton");
		if(e.selectedIndex != -1){
			var newdestton = e.options[e.selectedIndex].value;
			parametersstring = parametersstring + " newdestton "+newdestton;
		}
		
		e = document.getElementById("newdestnpi");
		if(e.selectedIndex != -1){
			var newdestnpi = e.options[e.selectedIndex].value;
			parametersstring = parametersstring + " newdestnpi "+newdestnpi;
		}
		
		var adddestdigprefix = $("#adddestdigprefix").val();
		if(adddestdigprefix == "") {
			adddestdigprefix = null;
		} else {
			parametersstring = parametersstring + " adddestdigprefix "+adddestdigprefix;
		}

		var addsourcedigprefix = $("#addsourcedigprefix").val();
		if(addsourcedigprefix == "") {
			addsourcedigprefix = null;
		} else {
			parametersstring = parametersstring + " addsourcedigprefix "+addsourcedigprefix;
		}
		
		var nsrc = document.getElementById("newsourceton");
		if(nsrc.selectedIndex != -1){
			var newsourceton = nsrc.options[nsrc.selectedIndex].value;
			parametersstring = parametersstring + " newsourceton "+newsourceton;
		}
		
		nsrc = document.getElementById("newsourcenpi");
		if(nsrc.selectedIndex != -1){
			var newsourcenpi = nsrc.options[nsrc.selectedIndex].value;
			parametersstring = parametersstring + " newsourcenpi "+newsourcenpi;
		}
		
		var newsourceaddr = $("#newsourceaddr").val();
		if(newsourceaddr == "") {
			newsourceaddr = null;
		} else {
			parametersstring = parametersstring + " newsourceaddr "+newsourceaddr;
		}
		
		var mtlocalsccpgt = $("#mtlocalsccpgt").val();
		if(mtlocalsccpgt.trim() == "") {
			mtlocalsccpgt = "-1";
		} else {
			parametersstring = parametersstring + " mtlocalsccpgt " + mtlocalsccpgt;
		}
		
		var mtremotesccptt = $("#mtremotesccptt").val();
		if(mtremotesccptt.trim() == "") {
			mtremotesccptt = "-1";
		} else {
			parametersstring = parametersstring + " mtremotesccptt " + mtremotesccptt;
		}

		e = document.getElementById("makecopy");
		var makecopy = e.options[e.selectedIndex].value;
		parametersstring = parametersstring + " makecopy "+makecopy;
		
		e = document.getElementById("hrbypass");
		var hrbypass = e.options[e.selectedIndex].value;
		parametersstring = parametersstring + " hrbypass "+hrbypass;
		
		e = document.getElementById("dropaftersri");
		var dropaftersri = e.options[e.selectedIndex].value;
		parametersstring = parametersstring + " dropaftersri "+dropaftersri;
		
		
		e = document.getElementById("dropaftertempfail");
		var dropaftertempfail = e.options[e.selectedIndex].value;
		parametersstring = parametersstring + " dropaftertempfail "+dropaftertempfail;
		
		var newnetworkidaftersri = $("#newnetworkidaftersri").val();
		if(newnetworkidaftersri.trim() == "") {
			newnetworkidaftersri = "-1";
		} else {
			parametersstring = parametersstring + " newnetworkidaftersri "+newnetworkidaftersri;
		}
		
		var newnetworkidafterpermfail = $("#newnetworkidafterpermfail").val();
		if(newnetworkidafterpermfail.trim() == "") {
			newnetworkidafterpermfail = "-1";
		} else {
			parametersstring = parametersstring + " newnetworkidafterpermfail "+newnetworkidafterpermfail;
		}
		
		var newnetworkidaftertempfail = $("#newnetworkidaftertempfail").val();
		if(newnetworkidaftertempfail.trim() == "") {
			newnetworkidaftertempfail = "-1";
		} else {
			parametersstring = parametersstring + " newnetworkidaftertempfail "+newnetworkidaftertempfail;
		}

		e = document.getElementById("droponarrival");
		var droponarrival = e.options[e.selectedIndex].value;
		parametersstring = parametersstring + " droponarrival "+droponarrival;
		
		e = document.getElementById("rejectonarrival");
		var rejectonarrival = e.options[e.selectedIndex].value;
		if (rejectonarrival == "" || rejectonarrival == "NONE") {
			rejectonarrival = null;		
		} else {
			parametersstring = parametersstring + " rejectonarrival "+rejectonarrival;
		}
		
		var remove_tlv = $("#remove_tlv").val();
		if(remove_tlv.trim() == "") {
			remove_tlv = "-1";
		} else {
			parametersstring = parametersstring + " remove_tlv "+remove_tlv;
		}

		parametersstring = parametersstring.trim();
		
		if(formInvalid) {
			$("#login-settings-error").show();
			logToConsole("ERROR", "Some Fields are not correctly filled out, please double check the settings !");
			return false;
		} else {
			$("#login-settings-error").hide();
		}
		
		var ruleclassname = "mproc";
		
		jolokia.execute("org.mobicents.smsc:layer=MProcManagement,name=SmscManagement","createMProcRule", id,ruleclassname,parametersstring, 
				{
					success: function(value) {
						updateMProc();
						logToConsole('INFO', 'MProc rule ' + id + ' created successfuly.');
						$('#entities-modal').modal('hide');
					},
					error: function(value){
						errorUID = ("st" + new Date().getTime()).hashCode();
						createStackTrace(errorUID, value.stacktrace);
						logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
					}					
				});		
		
	}
	
	function onModifyEsmeOk(mbeanName, propertyName, spanId){
		var skipCheck = false;
		onModifyEsmeOk(mbeanName, propertyName, spanId, skipCheck)
	}
	
	function onCustomModifyEsmeOk(mbeanName, className, spanId, skipCheck){
		var formInvalid = false;
		
		var spanElement = document.getElementById(spanId + "-input");
		var eleChild = spanElement.childNodes;
		var inputTextEle = eleChild[0];
		var spanElementTxt = document.getElementById(spanId + "-text");
		
		var propValue = inputTextEle.value;
		
		if(!skipCheck){
			if(propValue.trim() == "") {
				$("#div-"+spanId + "-input").addClass("error");					    			
				formInvalid = true;
			} else if($("#div-"+spanId + "-input").hasClass("error")) {
				$("#div-"+spanId + "-input").removeClass("error");		
			}	
			
			if(formInvalid) {
				$("#login-settings-error").show();
				logToConsole("ERROR", "Some Fields are not correctly filled out, please double check the settings !");
				return false;
			} else {
				$("#login-settings-error").hide();
			}
		}
		
		if(propValue == ""){
			propValue = "-1";
		}
		
		var mbeanSearch="org.mobicents.smsc:layer=MProcManagement,name=SmscManagement";
		jolokia.execute(mbeanSearch,"modifyMProcRule",mbeanName,propValue,
				{
					success: function(value) {
						updateMProc();
						logToConsole('INFO', 'Successfully modified rule ' + mbeanName );
						spanElementTxt.innerHTML= inputTextEle.value;
					},
					error: function(value){
						errorUID = ("st" + new Date().getTime()).hashCode();
						createStackTrace(errorUID, value.stacktrace);
						logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
					}
				});		
		
		spanElement.style.display = 'none';
		spanElementTxt.style.display = '';
		
		
	}
	
	function onModifyEsmeOk(mbeanName, propertyName, spanId, skipCheck){
		var formInvalid = false;
		var spanElement = document.getElementById(spanId + "-input");
		var eleChild = spanElement.childNodes;
		var spanElementTxt = document.getElementById(spanId + "-text");
		var inputTextEle;
		var propValue;
		//FIXME: this is tlv magic number specific
		if(eleChild.length>5){
			inputTextEle = [];
			inputTextEle[0] = eleChild[0];
			inputTextEle[1] = eleChild[2];
			inputTextEle[2] = eleChild[4];
			//rewrite propertyname
			propertyName = "tlv_"+inputTextEle[1].value+"_"+inputTextEle[0].value;
			propValue = inputTextEle[2].value;
		}else{
			inputTextEle = eleChild[0];
			propValue = inputTextEle.value;
		}

		if(!skipCheck){
			if(propValue.trim() == "") {
				$("#div-"+spanId + "-input").addClass("error");					    			
				formInvalid = true;
			} else if($("#div-"+spanId + "-input").hasClass("error")) {
				$("#div-"+spanId + "-input").removeClass("error");		
			}	
			
			if(formInvalid) {
				$("#login-settings-error").show();
				logToConsole("ERROR", "Some Fields are not correctly filled out, please double check the settings !");
				return false;
			} else {
				$("#login-settings-error").hide();
			}
		}

		if(propValue == ""){
			propValue = "-1";
		}

		var parametersstring = propertyName + " " + propValue;
		var mbeanSearch="org.mobicents.smsc:layer=MProcManagement,name=SmscManagement";
		jolokia.execute(mbeanSearch,"modifyMProcRule",mbeanName,parametersstring,
				{
					success: function(value) {
						updateMProc();
						logToConsole('INFO', 'Successfully modified rule ' + mbeanName );
						if(inputTextEle.length>1){
							spanElementTxt.innerHTML = inputTextEle[0].value + " "+inputTextEle[1].value+" "+inputTextEle[2].value;
						}else{
							spanElementTxt.innerHTML = inputTextEle.value;
						}

					},
					error: function(value){
						errorUID = ("st" + new Date().getTime()).hashCode();
						createStackTrace(errorUID, value.stacktrace);
						logToConsole("ERROR", value.error + ". (<a href=\"#" + errorUID + "-modal\" data-toggle=\"modal\">Full Stack Trace</a>)");
					}
				});		
		
		spanElement.style.display = 'none';
		spanElementTxt.style.display = '';
		
		
	}	
	$(document).ready(function () {
		updateMProc();
	});
</script>
